<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Elastic Load balancer (ELB) #aws #cloud #vpc #networking #loadbalancer
Loadbalancer service provided by AWS
Elastic Load Balancing supports the following types of load balancers: Application Load Balancers, Network Load Balancers, and Classic Load Balancers."><meta property="og:title" content><meta property="og:description" content="Elastic Load balancer (ELB) #aws #cloud #vpc #networking #loadbalancer
Loadbalancer service provided by AWS
Elastic Load Balancing supports the following types of load balancers: Application Load Balancers, Network Load Balancers, and Classic Load Balancers."><meta property="og:type" content="website"><meta property="og:image" content="https://shrestharajat.github.io/mgarden/icon.png"><meta property="og:url" content="https://shrestharajat.github.io/mgarden/-AWS-/--Compute--/Elastic-Load-Balancer-ELB/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Elastic Load balancer (ELB) #aws #cloud #vpc #networking #loadbalancer
Loadbalancer service provided by AWS
Elastic Load Balancing supports the following types of load balancers: Application Load Balancers, Network Load Balancers, and Classic Load Balancers."><meta name=twitter:image content="https://shrestharajat.github.io/mgarden/icon.png"><title>M Garden</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://shrestharajat.github.io/mgarden//icon.png><link href=https://shrestharajat.github.io/mgarden/styles.b369a84b3c6e6bfd686ad1f9da65641c.min.css rel=stylesheet><link href=https://shrestharajat.github.io/mgarden/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://shrestharajat.github.io/mgarden/js/darkmode.cbdc124701691e7511fa2b7a09fc2c18.min.js></script>
<script src=https://shrestharajat.github.io/mgarden/js/util.a0ccf91e1937fe761a74da4946452710.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script async src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script async src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script async src=https://shrestharajat.github.io/mgarden/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://shrestharajat.github.io/mgarden/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://shrestharajat.github.io/mgarden/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://shrestharajat.github.io/mgarden/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://shrestharajat.github.io/mgarden/",fetchData=Promise.all([fetch("https://shrestharajat.github.io/mgarden/indices/linkIndex.348d6a624c0ea02d89b6aafb37424ee6.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://shrestharajat.github.io/mgarden/indices/contentIndex.9fc7e947f2fa32fdd1bbeb432ab75b53.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://shrestharajat.github.io/mgarden",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!0;drawGraph("https://shrestharajat.github.io/mgarden",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/shrestharajat.github.io\/mgarden\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=shrestharajat.github.io/mgarden src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://shrestharajat.github.io/mgarden/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://shrestharajat.github.io/mgarden/>M Garden</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>Last updated
Mar 2, 2023
<a href="https://github.com/shrestharajat/mgarden/-=%20AWS%20=-/--%20Compute%20--/Elastic%20Load%20Balancer%20%28ELB%29.md" rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#common-features>Common Features</a></li></ol><ol><li><a href=#application-load-balancer-alb>Application Load Balancer (ALB)</a></li><li><a href=#network-load-balancer>Network Load Balancer</a></li><li><a href=#sticky-session>Sticky Session</a></li><li><a href=#x-forwarded-for-xff-header>X-Forwarded-For (XFF) Header</a></li><li><a href=#elb---health-checks>ELB - Health Checks</a></li><li><a href=#cross-zone-load-balancing>Cross-Zone Load Balancing</a></li><li><a href=#alb---request-routing>ALB - Request Routing</a></li></ol></nav></details></aside><a href=#elastic-load-balancer-elb><h1 id=elastic-load-balancer-elb><span class=hanchor arialabel=Anchor># </span>Elastic Load balancer (ELB)</h1></a><p>#aws #cloud #vpc #networking #loadbalancer</p><p>Loadbalancer service provided by
<a href=/mgarden/-AWS-/AWS/ rel=noopener class=internal-link data-src=/mgarden/-AWS-/AWS/>AWS</a></p><p>Elastic Load Balancing supports the following types of load balancers: <strong>Application Load Balancers, Network Load Balancers, and Classic Load Balancers</strong>.</p><a href=#common-features><h2 id=common-features><span class=hanchor arialabel=Anchor># </span>Common Features</h2></a><p>Let’s start by taking a look at what is common for all three types of load balancers. </p><p>Obviously, all AWS load balancers distribute incoming requests to a number of targets, which can be either EC2 instances or Docker containers. They all implement health checks, which are used to detect unhealthy instances. They are all highly available and elastic (in AWS parlance: They scale up and down within a few minutes according to workload). </p><p>TLS termination is a feature available for all three as well, and they can all be either internet-facing or internal. Finally, ELB, ALB, and NLB all export useful metrics to CloudWatch and can log pertinent information to CloudWatch Logs.</p><p><img src=https://shrestharajat.github.io/mgarden//-%20AWS%20-/--%20Compute%20--/Pasted%20image%2020220723213315.png width=auto alt="Pasted image 20220723213315"></p><a href=#classic-load-balancer-clb><h1 id=classic-load-balancer-clb><span class=hanchor arialabel=Anchor># </span>Classic Load Balancer (CLB)</h1></a><p>Widely known as CLB it was the original Elastic Load Balancer, as this was its name when it was first introduced in 2009 and was the only type of load balancer available. It can be thought of as an Nginx or HAProxy instance if that makes it easier for you to understand.</p><p>ELB works at both layer 4 (TCP) and 7 (HTTP) but not on the same time. It is the only load balancer that works in EC2-Classic, in case you have a very old AWS account. Also, it’s the only load balancer that supports application-defined sticky session cookies; in contrast, ALB uses its own cookies, and you have no control over that.</p><p>At layer 7, ELB can terminate TLS traffic. It can also re-encrypt the traffic to the targets as long as they provide an SSL certificate (a self-signed certificate is fine, BTW). This provides end-to-end encryption, which is a usual requirement in many compliance programs. Optionally, ELB can be configured to verify the TLS certificate provided by the target for extra security.</p><p>ELB has quite a few limitations. For example, it isn’t compatible with EKS containers running on Fargate. Also, it can’t forward traffic on more than one port per instance, and it doesn’t support forwarding to IP addresses—it can only forward to explicit EC2 instances or containers in ECS or EKS. Finally, ELB doesn’t support websockets; however, you may be able to work around this limitation by using layer 4.</p><p>To run an ELB in the us-east-1 region, it will cost you $0.025 per ELB-hour + $0.008 per GB of traffic.</p><p>AWS discourages the use of ELB in favor of its newer load balancers. Admittedly, there are very few scenarios where the use of an ELB would be preferable; typically, these are cases where you simply don’t have a choice. For example, your workload might still run on 
<a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-classic-platform.html rel=noopener>EC2-Classic</a>, or you need the load balancer to use your own sticky session cookies, in which cases ELB would be the only option available to you.</p><a href=#application-load-balancer-alb><h2 id=application-load-balancer-alb><span class=hanchor arialabel=Anchor># </span>Application Load Balancer (ALB)</h2></a><p>It works only on layer 7 (HTTP) of the
<a rel=noopener class="internal-link broken" data-src=OSI>OSI</a>. It has a wide range of routing rules for incoming requests based on host name, path, query string parameter, HTTP method, HTTP headers, source IP, or port number. In contrast, ELB only allows routing based on port number. Also, contrary to ELB, ALB can route requests to many ports on a single target. Plus, ALB can route requests to Lambda functions.</p><p>It has a feature called Request Routing which allows you to add routing rules to your application.</p><p>A very useful feature of ALB is that it can be configured to return a fixed response or a redirection. So you don’t need a server to perform such basic tasks because it is all embedded in the ALB itself. Also very importantly, ALB supports HTTP/2 and websockets.</p><p>ALB further supports 
<a href=https://www.cloudflare.com/learning/ssl/what-is-sni/ rel=noopener>Server Name Indication (SNI)</a>, which allows it to serve many domain names. (In contrast, ELB can serve only one domain name). There is a limit, however, to the number of certificates you can attach to an ALB, 
<a href=https://aws.amazon.com/blogs/aws/new-application-load-balancer-sni/ rel=noopener>namely 25 certificates</a> plus the default certificate.</p><p>An interesting feature of ALB is that it supports user authentication via a variety of methods, including OIDC, SAML, LDAP, Microsoft AD, and well-known social identity providers such as Facebook and Google. This can help you off-load the user authentication part of your application to the load balancer. </p><p>ALB pricing is a bit more complicated than ELB. For the us-east-1 region, it would cost you $0.0225 per ALB + $0.008 per LCU-hour. The definition of an LCU can be found 
<a href=https://aws.amazon.com/elasticloadbalancing/pricing/ rel=noopener>here</a>. All in all, pricing is roughly equivalent to ELB.</p><p>ALBs are typically used for web applications. If you have a microservices architecture, ALB can be used as an internal load balancer in front of EC2 instances or Docker containers that implement a given service. You can also use them in front of an application implementing a REST API, although 
<a href=https://aws.amazon.com/api-gateway/ rel=noopener>AWS API Gateway</a> would generally be a better choice here.</p><a href=#network-load-balancer><h2 id=network-load-balancer><span class=hanchor arialabel=Anchor># </span>Network Load Balancer</h2></a><p>NLB works on the layer 4 of the
<a rel=noopener class="internal-link broken" data-src=OSI%20model>OSI model</a> only and can handle both TCP and UDP, as well as TCP connections encrypted with TLS. Its main feature is that it has a very high performance. Also, it uses static IP addresses and can be assigned Elastic IPs—not possible with ALB and ELB.</p><p>NLB natively preserves the source IP address in TCP/UDP packets; in contrast, ALB and ELB can be configured to add additional HTTP headers with forwarding information, and those have to be parsed properly by your application.</p><p>NLB pricing for the us-east-1 region is $0.0225 per NLB-hour + $0.006 per LCU-hour. The definition of an LCU for NLB is quite similar to that for ALB, and more information can be found 
<a href=https://aws.amazon.com/elasticloadbalancing/pricing/ rel=noopener>here</a>. All in all, pricing is roughly equivalent to ELB and ALB.</p><p>NLBs would be used for anything that ALBs don’t cover. A typical use case would be a near real-time data streaming service (video, stock quotes, etc.) Another typical case is that you would need to use an NLB if your application uses non-HTTP protocols.</p><a href=#sticky-session><h2 id=sticky-session><span class=hanchor arialabel=Anchor># </span>Sticky Session</h2></a><p>A method to bind a user&rsquo;s session to a specific EC2 session.
can only be applied to CLB or ALBs</p><p>It ensures that all requests from that session are sent to the same instance. It is Typically utilized with a Classic Load Balancer</p><a href=#x-forwarded-for-xff-header><h2 id=x-forwarded-for-xff-header><span class=hanchor arialabel=Anchor># </span>X-Forwarded-For (XFF) Header</h2></a><p>If you need the IPv4 address of a user, check this header.</p><p>This header is a common method for identifying the originating IP addresses of clients connecting to a web server through an HTTP proxy or a load balancer.</p><p><img src=https://shrestharajat.github.io/mgarden//-%20AWS%20-/--%20Compute%20--/Pasted%20image%2020220723214311.png width=auto alt="Pasted image 20220723214311"></p><a href=#elb---health-checks><h2 id=elb---health-checks><span class=hanchor arialabel=Anchor># </span>ELB - Health Checks</h2></a><p><img src=https://shrestharajat.github.io/mgarden//-%20AWS%20-/--%20Compute%20--/Pasted%20image%2020220723214425.png width=auto alt="Pasted image 20220723214425"></p><a href=#cross-zone-load-balancing><h2 id=cross-zone-load-balancing><span class=hanchor arialabel=Anchor># </span>Cross-Zone Load Balancing</h2></a><p><img src=https://shrestharajat.github.io/mgarden//-%20AWS%20-/--%20Compute%20--/Pasted%20image%2020220723214447.png width=auto alt="Pasted image 20220723214447"></p><a href=#alb---request-routing><h2 id=alb---request-routing><span class=hanchor arialabel=Anchor># </span>ALB - Request Routing</h2></a><p>Apply riles to incomming request and then forward or redirect traffic</p><ul><li>Host header</li><li>HTTP header</li><li>Source IP</li><li>HTTP header method</li><li>Path</li><li>Query string
<img src=https://shrestharajat.github.io/mgarden//-%20AWS%20-/--%20Compute%20--/Pasted%20image%2020220723214622.png width=auto alt="Pasted image 20220723214622"></li></ul><p><img src=https://shrestharajat.github.io/mgarden//-%20AWS%20-/--%20Compute%20--/Pasted%20image%2020220723214636.png width=auto alt="Pasted image 20220723214636"></p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script async src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://shrestharajat.github.io/mgarden/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Rajat Shrestha using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://shrestharajat.github.io/mgarden/>Home</a></li><li><a href=https://linkedin.com/shrestharajat>Linkedin</a></li><li><a href=https://github.com/shrestharajat>GitHub</a></li></ul></footer></div></div></body></html>